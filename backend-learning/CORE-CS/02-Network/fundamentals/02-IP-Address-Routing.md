# IP Address & Routing - IP 주소와 라우팅

> "인터넷의 주소 체계"

## 🎯 학습 목표

- **IP 주소 구조** 이해
- **서브넷 마스크와 CIDR** 개념 파악
- **라우팅 동작 원리** 이해
- **공인 IP vs 사설 IP** 구분

## 📚 IP 주소 기초

### IPv4 주소 구조

```
192.168.1.100

- 32비트 (4바이트)
- 4개의 옥텟 (0~255)
- 약 43억 개 주소 (부족!)
```

### IP 주소 클래스 (구식 방법)

```
Class A: 0.0.0.0 ~ 127.255.255.255
  - 네트워크: 8비트, 호스트: 24비트
  - 예: 10.0.0.0

Class B: 128.0.0.0 ~ 191.255.255.255
  - 네트워크: 16비트, 호스트: 16비트
  - 예: 172.16.0.0

Class C: 192.0.0.0 ~ 223.255.255.255
  - 네트워크: 24비트, 호스트: 8비트
  - 예: 192.168.1.0
```

## 🔍 서브넷 마스크

### 개념

IP 주소를 네트워크 부분과 호스트 부분으로 구분

```
IP 주소:      192.168.1.100
서브넷 마스크: 255.255.255.0

네트워크 주소: 192.168.1.0   (같은 네트워크)
호스트 주소:   .100           (개별 기기)
```

### CIDR (Classless Inter-Domain Routing)

```
192.168.1.0/24

/24 = 앞의 24비트가 네트워크 부분
    = 255.255.255.0과 동일

사용 가능한 호스트: 2^(32-24) - 2 = 254개
- 네트워크 주소: 192.168.1.0 (첫 번째)
- 브로드캐스트: 192.168.1.255 (마지막)
- 호스트: 192.168.1.1 ~ 192.168.1.254
```

### CIDR 예제

```
192.168.1.0/24
- 네트워크: 192.168.1.0
- 호스트 범위: 192.168.1.1 ~ 192.168.1.254
- 브로드캐스트: 192.168.1.255
- 호스트 개수: 254개

192.168.1.0/25
- 네트워크: 192.168.1.0
- 호스트 범위: 192.168.1.1 ~ 192.168.1.126
- 브로드캐스트: 192.168.1.127
- 호스트 개수: 126개
```

## 💡 공인 IP vs 사설 IP

### 공인 IP (Public IP)

```
인터넷에서 유일한 주소
- ISP가 할당
- 외부에서 접근 가능
- 비용 발생
```

### 사설 IP (Private IP)

```
내부 네트워크에서만 사용

Class A: 10.0.0.0 ~ 10.255.255.255
Class B: 172.16.0.0 ~ 172.31.255.255
Class C: 192.168.0.0 ~ 192.168.255.255

- 무료
- 외부 접근 불가
- NAT로 공인 IP 변환
```

## 🔄 NAT (Network Address Translation)

### 동작 원리

```
집 안 (사설 IP)              인터넷 (공인 IP)
─────────────────────────────────────────────

PC1: 192.168.1.10  ┐
PC2: 192.168.1.11  ├→ 공유기 → 123.45.67.89 → 인터넷
PC3: 192.168.1.12  ┘   (NAT)
```

### NAT 테이블

```
내부 IP:Port        외부 IP:Port
────────────────────────────────────
192.168.1.10:5000 ↔ 123.45.67.89:50001
192.168.1.11:6000 ↔ 123.45.67.89:50002
192.168.1.12:7000 ↔ 123.45.67.89:50003
```

## 🗺️ 라우팅 (Routing)

### 라우팅이란?

패킷을 목적지까지 전달하는 경로 선택

```
출발지 (192.168.1.10)
    ↓
라우터 1 → 라우터 2 → 라우터 3
    ↓
목적지 (8.8.8.8)
```

### 라우팅 테이블

```bash
# 라우팅 테이블 확인
route -n  # Linux
netstat -rn  # macOS

# 예:
Destination     Gateway         Genmask         Iface
0.0.0.0         192.168.1.1     0.0.0.0         eth0  ← 기본 게이트웨이
192.168.1.0     0.0.0.0         255.255.255.0   eth0  ← 로컬 네트워크
```

### 라우팅 경로 추적

```bash
# traceroute
traceroute google.com

# 결과:
1  192.168.1.1       1 ms     # 공유기
2  10.1.1.1          5 ms     # ISP 라우터
3  172.16.1.1        10 ms    # ISP 백본
...
10 8.8.8.8           30 ms    # Google DNS
```

## 📊 서브넷팅 예제

### 문제: 192.168.1.0/24를 4개로 나누기

```
원래: 192.168.1.0/24 (254 호스트)

서브넷 1: 192.168.1.0/26   (62 호스트)
  - 범위: 192.168.1.1 ~ 192.168.1.62

서브넷 2: 192.168.1.64/26  (62 호스트)
  - 범위: 192.168.1.65 ~ 192.168.1.126

서브넷 3: 192.168.1.128/26 (62 호스트)
  - 범위: 192.168.1.129 ~ 192.168.1.190

서브넷 4: 192.168.1.192/26 (62 호스트)
  - 범위: 192.168.1.193 ~ 192.168.1.254
```

## 🔍 IP 주소 계산

### 이진수 변환

```
192.168.1.100을 이진수로:

192 = 11000000
168 = 10101000
1   = 00000001
100 = 01100100

192.168.1.100 = 11000000.10101000.00000001.01100100
```

### 서브넷 마스크 AND 연산

```
IP:     192.168.1.100 = 11000000.10101000.00000001.01100100
Mask:   255.255.255.0 = 11111111.11111111.11111111.00000000
                        ────────────────────────────────────
Network: 192.168.1.0  = 11000000.10101000.00000001.00000000
```

## 💻 실습

### 1. 내 IP 주소 확인

```bash
# Linux/macOS
ifconfig
ip addr show

# Windows
ipconfig

# 결과:
eth0: flags=4163<UP,BROADCAST,RUNNING,MULTICAST>
      inet 192.168.1.100  netmask 255.255.255.0  broadcast 192.168.1.255
```

### 2. 게이트웨이 확인

```bash
# Linux/macOS
route -n | grep UG

# Windows
route print

# 결과:
0.0.0.0         192.168.1.1     0.0.0.0         UG    0      0        0 eth0
```

### 3. DNS 확인

```bash
# 도메인 → IP 변환
nslookup google.com
dig google.com

# 결과:
Name:    google.com
Address: 172.217.175.46
```

### 4. Ping 테스트

```bash
# 연결 테스트
ping 8.8.8.8
ping google.com

# 결과:
64 bytes from 8.8.8.8: icmp_seq=1 ttl=117 time=10.2 ms
```

## 📱 IPv6 (미래)

### IPv6 주소

```
2001:0db8:85a3:0000:0000:8a2e:0370:7334

- 128비트 (16바이트)
- 8개 그룹 (16진수)
- 약 340간 개 주소 (거의 무한!)
```

### IPv4 고갈 문제 해결

```
IPv4: 43억 개 (부족)
IPv6: 340,282,366,920,938,463,463,374,607,431,768,211,456개

인류가 사용하기에 충분!
```

## 🎯 실무 시나리오

### 시나리오 1: 같은 네트워크 확인

```
PC1: 192.168.1.10/24
PC2: 192.168.1.20/24

네트워크 주소:
PC1: 192.168.1.0
PC2: 192.168.1.0

결과: 같은 네트워크 ✅ (직접 통신 가능)
```

### 시나리오 2: 다른 네트워크

```
PC1: 192.168.1.10/24
PC2: 192.168.2.10/24

네트워크 주소:
PC1: 192.168.1.0
PC2: 192.168.2.0

결과: 다른 네트워크 ❌ (라우터 필요)
```

### 시나리오 3: 서브넷 설계

```
회사 네트워크: 192.168.0.0/22

부서별 서브넷:
- 개발팀: 192.168.0.0/24   (254 호스트)
- 디자인팀: 192.168.1.0/24  (254 호스트)
- 마케팅팀: 192.168.2.0/24  (254 호스트)
- 관리팀: 192.168.3.0/24   (254 호스트)
```

## 🎯 체크리스트

- [ ] IP 주소 구조를 이해한다 (32비트, 4옥텟)
- [ ] 서브넷 마스크와 CIDR을 설명할 수 있다
- [ ] 공인 IP와 사설 IP를 구분할 수 있다
- [ ] NAT의 역할을 이해한다
- [ ] 라우팅 테이블을 읽을 수 있다
- [ ] traceroute로 경로를 추적할 수 있다

## 🔗 다음 학습

- [03-TCP-Basics.md](./03-TCP-Basics.md) - TCP 기초
- [../deep-dive/06-DNS-Deep-Dive.md](../deep-dive/06-DNS-Deep-Dive.md) - DNS 상세

---

**"IP 주소는 인터넷의 주소, 라우팅은 우편 배달"**
