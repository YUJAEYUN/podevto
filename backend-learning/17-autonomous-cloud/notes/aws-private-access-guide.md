# Private ì„œë¸Œë„· ì ‘ê·¼ ì™„ë²½ ê°€ì´ë“œ

> Bastion Host vs Session Manager - ì–´ë–»ê²Œ Private EC2/RDSì— ì ‘ì†í•˜ë‚˜?

## ëª©ì°¨
1. [ë¬¸ì œ: Private ì„œë¸Œë„·ì€ ì–´ë–»ê²Œ ì ‘ì†í•˜ë‚˜?](#ë¬¸ì œ-private-ì„œë¸Œë„·ì€-ì–´ë–»ê²Œ-ì ‘ì†í•˜ë‚˜)
2. [Bastion Host ì™„ë²½ ì´í•´](#bastion-host-ì™„ë²½-ì´í•´)
3. [Session Manager ì™„ë²½ ì´í•´](#session-manager-ì™„ë²½-ì´í•´)
4. [Bastion vs Session Manager ë¹„êµ](#bastion-vs-session-manager-ë¹„êµ)
5. [RDS ì ‘ì† ë°©ë²•](#rds-ì ‘ì†-ë°©ë²•)
6. [ì‹¤ì „ ì‹œë‚˜ë¦¬ì˜¤ì™€ ì„ íƒ ê¸°ì¤€](#ì‹¤ì „-ì‹œë‚˜ë¦¬ì˜¤ì™€-ì„ íƒ-ê¸°ì¤€)

---

## ë¬¸ì œ: Private ì„œë¸Œë„·ì€ ì–´ë–»ê²Œ ì ‘ì†í•˜ë‚˜?

### ë‹¹ì‹ ì˜ ì§ˆë¬¸

```
"Private ì„œë¸Œë„·ì— RDSë¥¼ ë‘ë©´ ì–´ë–»ê²Œ ì ‘ì†í•˜ì§€?"
"SSHë¡œ Private EC2ì— ë“¤ì–´ê°€ë ¤ë©´?"
"Public IPê°€ ì—†ëŠ”ë° ì–´ë–»ê²Œ ê´€ë¦¬í•˜ì§€?"
```

### ë¬¸ì œ ìƒí™©

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      VPC                                â”‚
â”‚                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ Public Subnet (10.0.1.0/24)                    â”‚    â”‚
â”‚  â”‚                                                â”‚    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                          â”‚    â”‚
â”‚  â”‚  â”‚ Web Server       â”‚                          â”‚    â”‚
â”‚  â”‚  â”‚ Public IP: âœ…    â”‚                          â”‚    â”‚
â”‚  â”‚  â”‚ SSH ê°€ëŠ¥ âœ…      â”‚                          â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                          â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ Private Subnet (10.0.2.0/24)                   â”‚    â”‚
â”‚  â”‚                                                â”‚    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚    â”‚
â”‚  â”‚  â”‚ App Server       â”‚  â”‚ RDS              â”‚   â”‚    â”‚
â”‚  â”‚  â”‚ Public IP: âŒ    â”‚  â”‚ Public IP: âŒ    â”‚   â”‚    â”‚
â”‚  â”‚  â”‚ SSH ë¶ˆê°€ âŒ      â”‚  â”‚ ì ‘ì† ë¶ˆê°€ âŒ     â”‚   â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚    â”‚
â”‚  â”‚                                                â”‚    â”‚
â”‚  â”‚  ğŸ¤” ì–´ë–»ê²Œ ì ‘ì†í•˜ì§€?                           â”‚    â”‚
â”‚  â”‚  â€¢ ë°°í¬ëŠ” ì–´ë–»ê²Œ?                              â”‚    â”‚
â”‚  â”‚  â€¢ ë¡œê·¸ í™•ì¸ì€?                                â”‚    â”‚
â”‚  â”‚  â€¢ DB ì¿¼ë¦¬ëŠ”?                                  â”‚    â”‚
â”‚  â”‚  â€¢ ë””ë²„ê¹…ì€?                                   â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3ê°€ì§€ í•´ê²° ë°©ë²•

```
1ï¸âƒ£ Bastion Host (Jump Box)
   â€¢ Public Subnetì— ì „ìš© EC2 ë°°ì¹˜
   â€¢ ì´ ì„œë²„ë¥¼ ê±°ì³ì„œ Private ì ‘ì†
   â€¢ ì „í†µì ì¸ ë°©ë²•

2ï¸âƒ£ AWS Systems Manager Session Manager
   â€¢ AWS ì„œë¹„ìŠ¤ë¡œ ë¸Œë¼ìš°ì €/CLIì—ì„œ ì§ì ‘ ì ‘ì†
   â€¢ Public IP ë¶ˆí•„ìš”
   â€¢ ìµœì‹  ê¶Œì¥ ë°©ë²• â­

3ï¸âƒ£ VPN / AWS Direct Connect
   â€¢ ì˜¨í”„ë ˆë¯¸ìŠ¤ì™€ VPC ì—°ê²°
   â€¢ ê¸°ì—… í™˜ê²½ì—ì„œ ì‚¬ìš©
```

---

## Bastion Host ì™„ë²½ ì´í•´

### Bastion Hostë€?

```
Bastion Host = "ì í”„ ì„œë²„" (Jump Box)
â€¢ Public Subnetì— ìœ„ì¹˜ (SSH ì ‘ì† ê°€ëŠ¥)
â€¢ Private Subnetìœ¼ë¡œ ê°€ëŠ” ê´€ë¬¸ ì—­í• 
â€¢ ìµœì†Œí•œì˜ ì†Œí”„íŠ¸ì›¨ì–´ë§Œ ì„¤ì¹˜ (ë³´ì•ˆ)

ì¼ìƒ ë¹„ìœ :
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ì•„íŒŒíŠ¸ ê²½ë¹„ì‹¤                                  â”‚
â”‚  â€¢ ì™¸ë¶€ì¸ì€ ê²½ë¹„ì‹¤ì—ì„œ í™•ì¸ í›„ ì…ì¥           â”‚
â”‚  â€¢ ê²½ë¹„ì‹¤ í†µê³¼í•´ì•¼ ê° ì§‘ìœ¼ë¡œ ê°ˆ ìˆ˜ ìˆìŒ       â”‚
â”‚  â€¢ Bastion = ê²½ë¹„ì‹¤                            â”‚
â”‚  â€¢ Private EC2/RDS = ê° ì§‘                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Bastion Host ì•„í‚¤í…ì²˜

```
ê°œë°œì PC (211.234.123.45)
       â”‚
       â”‚ SSH (22 í¬íŠ¸)
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ VPC                                                     â”‚
â”‚                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ Public Subnet                                  â”‚    â”‚
â”‚  â”‚                                                â”‚    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚    â”‚
â”‚  â”‚  â”‚  Bastion Host                        â”‚     â”‚    â”‚
â”‚  â”‚  â”‚  â€¢ Public IP: 3.35.50.100           â”‚     â”‚    â”‚
â”‚  â”‚  â”‚  â€¢ ë³´ì•ˆê·¸ë£¹: sg-bastion             â”‚     â”‚    â”‚
â”‚  â”‚  â”‚    - In: 22/admin-ip-only           â”‚     â”‚    â”‚
â”‚  â”‚  â”‚    - Out: 22/sg-private             â”‚     â”‚    â”‚
â”‚  â”‚  â”‚  â€¢ ìµœì†Œ ì†Œí”„íŠ¸ì›¨ì–´ (SSHë§Œ)           â”‚     â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                  â”‚                                     â”‚
â”‚                  â”‚ SSH (22 í¬íŠ¸)                       â”‚
â”‚                  â–¼                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ Private Subnet                                 â”‚    â”‚
â”‚  â”‚                                                â”‚    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚    â”‚
â”‚  â”‚  â”‚ App Server       â”‚  â”‚ RDS              â”‚   â”‚    â”‚
â”‚  â”‚  â”‚ Private IP:      â”‚  â”‚ Private IP:      â”‚   â”‚    â”‚
â”‚  â”‚  â”‚ 10.0.2.10        â”‚  â”‚ 10.0.2.20        â”‚   â”‚    â”‚
â”‚  â”‚  â”‚                  â”‚  â”‚                  â”‚   â”‚    â”‚
â”‚  â”‚  â”‚ ë³´ì•ˆê·¸ë£¹:        â”‚  â”‚ ë³´ì•ˆê·¸ë£¹:        â”‚   â”‚    â”‚
â”‚  â”‚  â”‚ â€¢ In: 22/        â”‚  â”‚ â€¢ In: 5432/      â”‚   â”‚    â”‚
â”‚  â”‚  â”‚   sg-bastion âœ…  â”‚  â”‚   sg-bastion âœ…  â”‚   â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ğŸ’¡ í•µì‹¬: Bastionì„ ê±°ì³ì„œë§Œ Private ì ‘ê·¼ ê°€ëŠ¥
```

### Bastion Host ì„¤ì •

```bash
# 1ï¸âƒ£ Bastion Host ìƒì„±
# â€¢ AMI: Amazon Linux 2
# â€¢ Instance Type: t3.micro (ìµœì†Œ ì‚¬ì–‘)
# â€¢ Subnet: Public Subnet
# â€¢ Auto-assign Public IP: Enable
# â€¢ Security Group: sg-bastion

# 2ï¸âƒ£ Bastion ë³´ì•ˆê·¸ë£¹ (sg-bastion)
Inbound:
â”Œâ”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Type â”‚ Protocol â”‚ Port   â”‚ Source          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ SSH  â”‚ TCP      â”‚ 22     â”‚ 1.2.3.4/32      â”‚ â† ê´€ë¦¬ì IPë§Œ!
â””â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

âš ï¸  ì¤‘ìš”: Sourceë¥¼ ê´€ë¦¬ì IPë¡œ ì œí•œ
   0.0.0.0/0 (ëª¨ë“  IP)ëŠ” ì ˆëŒ€ ê¸ˆì§€!

Outbound:
â”Œâ”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Type â”‚ Protocol â”‚ Port   â”‚ Destination     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ SSH  â”‚ TCP      â”‚ 22     â”‚ 10.0.2.0/24     â”‚ â† Private Subnet
â”‚ PostgreSQLâ”‚TCP  â”‚ 5432   â”‚ sg-db           â”‚ â† DB ì ‘ì†ìš©
â””â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

# 3ï¸âƒ£ Private EC2 ë³´ì•ˆê·¸ë£¹ (sg-private)
Inbound:
â”Œâ”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Type â”‚ Protocol â”‚ Port   â”‚ Source          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ SSH  â”‚ TCP      â”‚ 22     â”‚ sg-bastion âœ…   â”‚ â† Bastionë§Œ í—ˆìš©
â””â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

# 4ï¸âƒ£ RDS ë³´ì•ˆê·¸ë£¹ (sg-db)
Inbound:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Type     â”‚ Protocol â”‚ Port   â”‚ Source          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ PostgreSQLâ”‚ TCP     â”‚ 5432   â”‚ sg-bastion âœ…   â”‚ â† Bastion
â”‚ PostgreSQLâ”‚ TCP     â”‚ 5432   â”‚ sg-app     âœ…   â”‚ â† App ì„œë²„
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### SSH ì ‘ì† ë°©ë²•

```bash
# ë°©ë²• 1: 2ë‹¨ê³„ SSH (ìˆ˜ë™)

# Step 1: Bastionì— ì ‘ì†
ssh -i bastion-key.pem ec2-user@3.35.50.100

# Step 2: Bastionì—ì„œ Private EC2ë¡œ ì ‘ì†
ssh -i private-key.pem ec2-user@10.0.2.10

# âŒ ë¬¸ì œì :
# â€¢ Private keyë¥¼ Bastionì— ë³µì‚¬í•´ì•¼ í•¨ (ë³´ì•ˆ ìœ„í—˜!)
# â€¢ 2ë²ˆ SSH ëª…ë ¹ ì‹¤í–‰ (ë¶ˆí¸)

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

# ë°©ë²• 2: SSH ProxyJump (ê¶Œì¥) âœ…

ssh -J ec2-user@3.35.50.100 ec2-user@10.0.2.10

# ë˜ëŠ” ~/.ssh/config ì„¤ì •:
# Host bastion
#   HostName 3.35.50.100
#   User ec2-user
#   IdentityFile ~/.ssh/bastion-key.pem
#
# Host private-app
#   HostName 10.0.2.10
#   User ec2-user
#   IdentityFile ~/.ssh/private-key.pem
#   ProxyJump bastion

# ê·¸ í›„:
ssh private-app

# âœ… ì¥ì :
# â€¢ Private keyë¥¼ ë¡œì»¬ì—ë§Œ ë³´ê´€
# â€¢ í•œ ë²ˆì— ì ‘ì†
# â€¢ íˆ¬ëª…í•œ í„°ë„ë§

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

# ë°©ë²• 3: SSH í„°ë„ (í¬íŠ¸ í¬ì›Œë”©)

# RDS ì ‘ì†ìš© í„°ë„ ìƒì„±
ssh -L 5432:10.0.2.20:5432 -i bastion-key.pem ec2-user@3.35.50.100

# ì´ì œ ë¡œì»¬ì—ì„œ RDS ì ‘ì† ê°€ëŠ¥!
psql -h localhost -p 5432 -U postgres -d mydb

# ë˜ëŠ” GUI ë„êµ¬ (DBeaver, DataGrip):
# Host: localhost
# Port: 5432
# (ì‹¤ì œë¡œëŠ” Bastionì„ í†µí•´ 10.0.2.20:5432ë¡œ ì—°ê²°ë¨)

# âœ… ì¥ì :
# â€¢ ë¡œì»¬ ë„êµ¬ ì‚¬ìš© ê°€ëŠ¥
# â€¢ RDSì— Public IP ë¶ˆí•„ìš”
```

### Bastion Host ë³´ì•ˆ ê°•í™”

```bash
# 1ï¸âƒ£ SSH í‚¤ ê¸°ë°˜ ì¸ì¦ë§Œ í—ˆìš© (íŒ¨ìŠ¤ì›Œë“œ ê¸ˆì§€)
sudo vi /etc/ssh/sshd_config

PasswordAuthentication no
PubkeyAuthentication yes

sudo systemctl restart sshd

# 2ï¸âƒ£ ë¶ˆí•„ìš”í•œ íŒ¨í‚¤ì§€ ì œê±°
sudo yum remove -y telnet ftp

# 3ï¸âƒ£ ì ‘ì† ë¡œê·¸ CloudWatchë¡œ ì „ì†¡
sudo yum install -y amazon-cloudwatch-agent

# /opt/aws/amazon-cloudwatch-agent/etc/config.json
{
  "logs": {
    "logs_collected": {
      "files": {
        "collect_list": [
          {
            "file_path": "/var/log/secure",
            "log_group_name": "/aws/bastion/ssh",
            "log_stream_name": "{instance_id}"
          }
        ]
      }
    }
  }
}

# 4ï¸âƒ£ Fail2Ban ì„¤ì¹˜ (ë¬´ì°¨ë³„ ëŒ€ì… ê³µê²© ì°¨ë‹¨)
sudo yum install -y fail2ban
sudo systemctl enable fail2ban
sudo systemctl start fail2ban

# 5ï¸âƒ£ ì •ê¸°ì ì¸ ë³´ì•ˆ ì—…ë°ì´íŠ¸
sudo yum update -y
```

### Bastion Host ë¹„ìš©

```
ì›” ë¹„ìš©:
â€¢ EC2 t3.micro: $7.5/ì›”
â€¢ Elastic IP: $0 (ì‚¬ìš© ì¤‘)
â€¢ ë°ì´í„° ì „ì†¡: ë¬´ì‹œ ê°€ëŠ¥ (SSHë§Œ)

í•©ê³„: ì•½ $7.5/ì›” (â‚©10,000)
```

---

## Session Manager ì™„ë²½ ì´í•´

### Session Managerë€?

```
AWS Systems Manager Session Manager
â€¢ ë¸Œë¼ìš°ì €/CLIì—ì„œ EC2ì— ì§ì ‘ ì ‘ì†
â€¢ SSH í¬íŠ¸(22) ë¶ˆí•„ìš”
â€¢ Public IP ë¶ˆí•„ìš”
â€¢ Bastion Host ë¶ˆí•„ìš”
â€¢ IAMìœ¼ë¡œ ê¶Œí•œ ê´€ë¦¬
â€¢ ëª¨ë“  ì„¸ì…˜ ë¡œê·¸ ê¸°ë¡ (ê°ì‚¬ ì¶”ì )

ì¼ìƒ ë¹„ìœ :
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Bastion = ê²½ë¹„ì‹¤ì„ ê±°ì³ì„œ ì…ì¥                â”‚
â”‚           (ê²½ë¹„ì‹¤ì´ ê³ ì¥ë‚˜ë©´ ì…ì¥ ëª» í•¨)       â”‚
â”‚                                                â”‚
â”‚ Session Manager = ë§ˆë²•ì˜ ìˆœê°„ì´ë™ ğŸª„           â”‚
â”‚                  (ì§ì ‘ í…”ë ˆí¬íŠ¸!)              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Session Manager ì•„í‚¤í…ì²˜

```
ê°œë°œì
  â”‚
  â”‚ AWS Console ë˜ëŠ” CLI
  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ AWS Systems Manager Serviceâ”‚
â”‚ (AWS ê´€ë¦¬ ì„œë¹„ìŠ¤)            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â”‚ HTTPS (443)
               â”‚ AWS PrivateLink
               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ VPC                                                     â”‚
â”‚                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ Private Subnet (Public IP ì—†ìŒ!)               â”‚    â”‚
â”‚  â”‚                                                â”‚    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚    â”‚
â”‚  â”‚  â”‚ EC2 Instance                         â”‚     â”‚    â”‚
â”‚  â”‚  â”‚ â€¢ Public IP: âŒ ì—†ì–´ë„ ë¨!           â”‚     â”‚    â”‚
â”‚  â”‚  â”‚ â€¢ SSH í¬íŠ¸(22): ë‹«í˜€ìˆì–´ë„ ë¨!       â”‚     â”‚    â”‚
â”‚  â”‚  â”‚ â€¢ SSM Agent ì‹¤í–‰ ì¤‘ âœ…               â”‚     â”‚    â”‚
â”‚  â”‚  â”‚ â€¢ IAM Role: SSMManagedInstanceCore   â”‚     â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚    â”‚
â”‚  â”‚              â”‚                                â”‚    â”‚
â”‚  â”‚              â”‚ HTTPS (443)                    â”‚    â”‚
â”‚  â”‚              â–¼                                â”‚    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚    â”‚
â”‚  â”‚  â”‚ VPC Endpoint (Interface)               â”‚   â”‚    â”‚
â”‚  â”‚  â”‚ â€¢ ssm.region.amazonaws.com             â”‚   â”‚    â”‚
â”‚  â”‚  â”‚ â€¢ ec2messages.region.amazonaws.com     â”‚   â”‚    â”‚
â”‚  â”‚  â”‚ â€¢ ssmmessages.region.amazonaws.com     â”‚   â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ğŸ’¡ í•µì‹¬:
â€¢ NAT Gatewayë„ í•„ìš” ì—†ìŒ (VPC Endpoint ì‚¬ìš©)
â€¢ SSH í¬íŠ¸ ì—´ í•„ìš” ì—†ìŒ (HTTPSë§Œ)
â€¢ Bastion Host ë¶ˆí•„ìš” (ë¹„ìš© ì ˆê°!)
```

### Session Manager ì„¤ì •

```bash
# 1ï¸âƒ£ IAM Role ìƒì„± (EC2ì— ì—°ê²°)
Role Name: EC2-SSM-Role
Managed Policy: AmazonSSMManagedInstanceCore

{
  "Version": "2012-10-17",
  "Statement": [
    {
      "Effect": "Allow",
      "Action": [
        "ssm:UpdateInstanceInformation",
        "ssmmessages:CreateControlChannel",
        "ssmmessages:CreateDataChannel",
        "ssmmessages:OpenControlChannel",
        "ssmmessages:OpenDataChannel"
      ],
      "Resource": "*"
    },
    {
      "Effect": "Allow",
      "Action": [
        "s3:GetEncryptionConfiguration"
      ],
      "Resource": "*"
    }
  ]
}

# 2ï¸âƒ£ EC2ì— IAM Role ì—°ê²°
# AWS Console â†’ EC2 â†’ Actions â†’ Security â†’ Modify IAM Role
# â†’ EC2-SSM-Role ì„ íƒ

# 3ï¸âƒ£ VPC Endpoint ìƒì„± (Private Subnetì¸ ê²½ìš°)
# com.amazonaws.region.ssm
# com.amazonaws.region.ec2messages
# com.amazonaws.region.ssmmessages

# ë¹„ìš©: 3ê°œ Ã— $0.01/ì‹œê°„ Ã— 2 AZ = $43.2/ì›”
# (í•˜ì§€ë§Œ Bastion $7.5 + NAT $32.4 = $39.9ë³´ë‹¤ ì•½ê°„ ë¹„ìŒˆ)
# â†’ ë³´ì•ˆê³¼ í¸ì˜ì„± ê³ ë ¤í•˜ë©´ ê°€ì¹˜ ìˆìŒ!

# 4ï¸âƒ£ SSM Agent í™•ì¸ (Amazon Linux 2ëŠ” ê¸°ë³¸ ì„¤ì¹˜)
sudo systemctl status amazon-ssm-agent

# ì„¤ì¹˜ ì•ˆ ë˜ì–´ ìˆìœ¼ë©´:
sudo yum install -y amazon-ssm-agent
sudo systemctl enable amazon-ssm-agent
sudo systemctl start amazon-ssm-agent
```

### Session Manager ì‚¬ìš© ë°©ë²•

```bash
# ë°©ë²• 1: AWS Console (ë¸Œë¼ìš°ì €)
# AWS Console â†’ Systems Manager â†’ Session Manager
# â†’ Start session â†’ ì¸ìŠ¤í„´ìŠ¤ ì„ íƒ â†’ Start session
# â†’ ë¸Œë¼ìš°ì €ì—ì„œ í„°ë¯¸ë„ ì—´ë¦¼! âœ…

# ì¥ì :
# â€¢ SSH í‚¤ ë¶ˆí•„ìš”
# â€¢ ì¸í„°ë„·ë§Œ ë˜ë©´ ì–´ë””ì„œë‚˜ ì ‘ì†
# â€¢ íšŒì‚¬ PC, ì§‘ PC ê°€ë¦¬ì§€ ì•ŠìŒ

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

# ë°©ë²• 2: AWS CLI

# ì¸ìŠ¤í„´ìŠ¤ ëª©ë¡ í™•ì¸
aws ssm describe-instance-information \
  --query 'InstanceInformationList[*].[InstanceId,PingStatus]' \
  --output table

# ì„¸ì…˜ ì‹œì‘
aws ssm start-session --target i-1234567890abcdef0

# âœ… ë°”ë¡œ EC2 í„°ë¯¸ë„ ì ‘ì†ë¨!

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

# ë°©ë²• 3: SSH-like ì ‘ì† (Session Manager Plugin)

# í”ŒëŸ¬ê·¸ì¸ ì„¤ì¹˜
# macOS:
brew install --cask session-manager-plugin

# Linux:
curl "https://s3.amazonaws.com/session-manager-downloads/plugin/latest/linux_64bit/session-manager-plugin.rpm" -o "session-manager-plugin.rpm"
sudo yum install -y session-manager-plugin.rpm

# ~/.ssh/config ì„¤ì •:
# Host i-* mi-*
#   ProxyCommand sh -c "aws ssm start-session --target %h --document-name AWS-StartSSHSession --parameters 'portNumber=%p'"

# ì´ì œ SSHì²˜ëŸ¼ ì ‘ì†!
ssh ec2-user@i-1234567890abcdef0

# âœ… SSH ëª…ë ¹ì–´ ê·¸ëŒ€ë¡œ ì‚¬ìš© ê°€ëŠ¥
# âœ… SCP, rsyncë„ ë™ì‘!

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

# ë°©ë²• 4: í¬íŠ¸ í¬ì›Œë”© (RDS ì ‘ì†)

# RDSë¡œ í¬íŠ¸ í¬ì›Œë”©
aws ssm start-session \
  --target i-1234567890abcdef0 \
  --document-name AWS-StartPortForwardingSessionToRemoteHost \
  --parameters '{"host":["mydb.xxxx.ap-northeast-2.rds.amazonaws.com"],"portNumber":["5432"],"localPortNumber":["5432"]}'

# ì´ì œ ë¡œì»¬ì—ì„œ RDS ì ‘ì†!
psql -h localhost -p 5432 -U postgres -d mydb

# âœ… Bastion ë¶ˆí•„ìš”!
```

### Session Manager ë¡œê·¸ ê¸°ë¡

```bash
# CloudWatch Logsë¡œ ì„¸ì…˜ ë¡œê·¸ ì „ì†¡

# Systems Manager â†’ Session Manager â†’ Preferences
# CloudWatch logging: Enable

# ë˜ëŠ” AWS CLI:
aws ssm update-document \
  --name "SSM-SessionManagerRunShell" \
  --content '{
    "schemaVersion": "1.0",
    "description": "Document to hold regional settings for Session Manager",
    "sessionType": "Standard_Stream",
    "inputs": {
      "cloudWatchLogGroupName": "/aws/ssm/sessions",
      "cloudWatchEncryptionEnabled": true,
      "s3BucketName": "my-session-logs-bucket",
      "s3EncryptionEnabled": true
    }
  }'

# ê²°ê³¼:
# â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
# â”‚ ëª¨ë“  ì„¸ì…˜ ëª…ë ¹ì–´ê°€ CloudWatchì— ê¸°ë¡ë¨     â”‚
# â”‚ â€¢ ëˆ„ê°€ (IAM User)                          â”‚
# â”‚ â€¢ ì–¸ì œ (Timestamp)                         â”‚
# â”‚ â€¢ ì–´ë””ì— (Instance ID)                     â”‚
# â”‚ â€¢ ë¬´ì—‡ì„ (Commands)                        â”‚
# â”‚                                            â”‚
# â”‚ ê°ì‚¬ ì¶”ì (Audit Trail) ì™„ë²½! âœ…            â”‚
# â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

# S3ì—ë„ ì €ì¥ ê°€ëŠ¥ (ì¥ê¸° ë³´ê´€)
```

---

## Bastion vs Session Manager ë¹„êµ

### ì™„ë²½ ë¹„êµí‘œ

| íŠ¹ì„± | Bastion Host | Session Manager |
|------|-------------|-----------------|
| **Public IP í•„ìš”** | âœ… Bastionì— í•„ìš” | âŒ ë¶ˆí•„ìš” |
| **SSH í¬íŠ¸(22) ì—´ê¸°** | âœ… í•„ìš” | âŒ ë¶ˆí•„ìš” (HTTPSë§Œ) |
| **SSH í‚¤ ê´€ë¦¬** | í•„ìš” (ë¶„ì‹¤ ìœ„í—˜) | ë¶ˆí•„ìš” (IAM) |
| **ì¸í”„ë¼ ê´€ë¦¬** | EC2 ìš´ì˜ í•„ìš” | ê´€ë¦¬ ë¶ˆí•„ìš” |
| **ë¹„ìš©** | $7.5/ì›” (t3.micro) | $0 (ë˜ëŠ” VPC Endpoint $43/ì›”) |
| **ë³´ì•ˆ** | ì¢‹ìŒ (SSH í¬íŠ¸ ë…¸ì¶œ) | ë§¤ìš° ì¢‹ìŒ (í¬íŠ¸ ì•ˆ ì—´ë¦¼) |
| **ì ‘ì† ë°©ë²•** | SSH í´ë¼ì´ì–¸íŠ¸ | ë¸Œë¼ìš°ì €/CLI |
| **ë¡œê·¸ ê¸°ë¡** | ìˆ˜ë™ ì„¤ì • í•„ìš” | ìë™ ê¸°ë¡ (CloudWatch) |
| **Multi-Factor Auth** | ë³„ë„ ì„¤ì • | IAM MFA ì—°ë™ |
| **ê¶Œí•œ ê´€ë¦¬** | ë³´ì•ˆê·¸ë£¹ + SSH í‚¤ | IAM Policy |
| **ê³ ê°€ìš©ì„±** | ìˆ˜ë™ ì„¤ì • (ì—¬ëŸ¬ AZ) | AWS ìë™ ê´€ë¦¬ |
| **ë„¤íŠ¸ì›Œí¬ êµ¬ì„±** | Public Subnet í•„ìš” | Privateë§Œìœ¼ë¡œ ê°€ëŠ¥ |

### ì¥ë‹¨ì  ë¹„êµ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Bastion Host                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                         â”‚
â”‚ âœ… ì¥ì :                                                â”‚
â”‚  â€¢ ê°„ë‹¨í•œ ê°œë… (ì „í†µì  ë°©ë²•)                            â”‚
â”‚  â€¢ ì„¤ì • ì‰¬ì›€                                            â”‚
â”‚  â€¢ ë¹„ìš© ì €ë ´ ($7.5/ì›”)                                  â”‚
â”‚  â€¢ ë‹¤ë¥¸ SSH ê¸°ëŠ¥ í™œìš© ê°€ëŠ¥ (SCP, rsync...)              â”‚
â”‚  â€¢ VPC Endpoint ë¶ˆí•„ìš”                                  â”‚
â”‚                                                         â”‚
â”‚ âŒ ë‹¨ì :                                                â”‚
â”‚  â€¢ ì¸í”„ë¼ ê´€ë¦¬ ë¶€ë‹´ (íŒ¨ì¹˜, ì—…ë°ì´íŠ¸)                    â”‚
â”‚  â€¢ SSH í¬íŠ¸ ë…¸ì¶œ (ë³´ì•ˆ ìœ„í—˜)                            â”‚
â”‚  â€¢ SSH í‚¤ ê´€ë¦¬ í•„ìš” (ë¶„ì‹¤, ìœ ì¶œ ìœ„í—˜)                   â”‚
â”‚  â€¢ ë‹¨ì¼ ì¥ì• ì  (Bastion ì£½ìœ¼ë©´ ì ‘ì† ë¶ˆê°€)               â”‚
â”‚  â€¢ ë¡œê·¸ ê¸°ë¡ ìˆ˜ë™ ì„¤ì •                                  â”‚
â”‚  â€¢ ì—¬ëŸ¬ ê´€ë¦¬ì ì ‘ì† ì‹œ í‚¤ ê³µìœ  ë¬¸ì œ                     â”‚
â”‚                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   Session Manager                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                         â”‚
â”‚ âœ… ì¥ì :                                                â”‚
â”‚  â€¢ ì¸í”„ë¼ ê´€ë¦¬ ë¶ˆí•„ìš” (Serverless)                      â”‚
â”‚  â€¢ SSH í¬íŠ¸ ì•ˆ ì—´ì–´ë„ ë¨ (ë³´ì•ˆ ê°•í™”)                    â”‚
â”‚  â€¢ IAMìœ¼ë¡œ ì„¸ë°€í•œ ê¶Œí•œ ì œì–´                             â”‚
â”‚  â€¢ ëª¨ë“  ì„¸ì…˜ ìë™ ë¡œê·¸ (ê°ì‚¬ ì¶”ì )                      â”‚
â”‚  â€¢ MFA ì—°ë™ ê°€ëŠ¥                                        â”‚
â”‚  â€¢ ë¸Œë¼ìš°ì €ì—ì„œ ë°”ë¡œ ì ‘ì† (í¸ë¦¬í•¨)                      â”‚
â”‚  â€¢ Private Subnetë§Œìœ¼ë¡œ êµ¬ì„± ê°€ëŠ¥                       â”‚
â”‚  â€¢ ë‹¨ì¼ ì¥ì• ì  ì—†ìŒ (AWS ì„œë¹„ìŠ¤)                        â”‚
â”‚                                                         â”‚
â”‚ âŒ ë‹¨ì :                                                â”‚
â”‚  â€¢ VPC Endpoint í•„ìš” (Private Subnet ì‹œ)                â”‚
â”‚  â€¢ VPC Endpoint ë¹„ìš© ($43/ì›”)                           â”‚
â”‚  â€¢ SSM Agent ì„¤ì¹˜ ë° ê´€ë¦¬ í•„ìš”                          â”‚
â”‚  â€¢ IAM Role ì„¤ì • í•„ìš” (ì´ˆê¸° í•™ìŠµ ê³¡ì„ )                  â”‚
â”‚  â€¢ ì¼ë¶€ ê³ ê¸‰ SSH ê¸°ëŠ¥ ì œì•½                              â”‚
â”‚                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## RDS ì ‘ì† ë°©ë²•

### RDSëŠ” EC2ê°€ ì•„ë‹ˆë¼ ì–´ë–»ê²Œ ì ‘ì†í•˜ë‚˜?

```
RDS = Managed Service (ì§ì ‘ SSH ë¶ˆê°€)
â†’ ë„¤íŠ¸ì›Œí¬ ê²½ë¡œë§Œ í™•ë³´í•˜ë©´ ë¨

3ê°€ì§€ ë°©ë²•:
1ï¸âƒ£ Bastion Host ê²½ìœ  (SSH í„°ë„)
2ï¸âƒ£ Session Manager ê²½ìœ  (í¬íŠ¸ í¬ì›Œë”©)
3ï¸âƒ£ VPN / Direct Connect
```

### ë°©ë²• 1: Bastionì„ í†µí•œ SSH í„°ë„

```bash
# Bastionì—ì„œ RDSë¡œ í¬íŠ¸ í¬ì›Œë”©
ssh -L 5432:mydb.xxxx.rds.amazonaws.com:5432 \
    -i bastion-key.pem \
    ec2-user@3.35.50.100

# ë‹¤ë¥¸ í„°ë¯¸ë„ì—ì„œ ë¡œì»¬ë¡œ ì ‘ì†
psql -h localhost -p 5432 -U postgres -d mydb

# ë˜ëŠ” GUI ë„êµ¬ (DBeaver, DataGrip):
# Host: localhost
# Port: 5432
# User: postgres
# Password: ****

# íë¦„:
# â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
# â”‚ ë¡œì»¬ PC (localhost:5432)                   â”‚
# â”‚   â†“ SSH í„°ë„                               â”‚
# â”‚ Bastion (3.35.50.100)                      â”‚
# â”‚   â†“ Private ë„¤íŠ¸ì›Œí¬                       â”‚
# â”‚ RDS (mydb.xxxx.rds.amazonaws.com:5432)     â”‚
# â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ë°©ë²• 2: Session Managerë¥¼ í†µí•œ í¬íŠ¸ í¬ì›Œë”©

```bash
# 1ï¸âƒ£ Private Subnetì— EC2 í•˜ë‚˜ ë„ìš°ê¸° (t3.micro)
# â€¢ ì´ë¦„: db-tunnel
# â€¢ ìš©ë„: DB ì ‘ì† ì „ìš©
# â€¢ IAM Role: SSM ê¶Œí•œ
# â€¢ ë³´ì•ˆê·¸ë£¹: RDS ì ‘ê·¼ ê°€ëŠ¥

# 2ï¸âƒ£ Session Managerë¡œ í¬íŠ¸ í¬ì›Œë”©
aws ssm start-session \
  --target i-tunnel-instance-id \
  --document-name AWS-StartPortForwardingSessionToRemoteHost \
  --parameters '{
    "host":["mydb.xxxx.rds.amazonaws.com"],
    "portNumber":["5432"],
    "localPortNumber":["5432"]
  }'

# 3ï¸âƒ£ ë¡œì»¬ì—ì„œ RDS ì ‘ì†
psql -h localhost -p 5432 -U postgres -d mydb

# íë¦„:
# â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
# â”‚ ë¡œì»¬ PC (localhost:5432)                   â”‚
# â”‚   â†“ Session Manager (HTTPS)                â”‚
# â”‚ EC2 db-tunnel (Private Subnet)             â”‚
# â”‚   â†“ Private ë„¤íŠ¸ì›Œí¬                       â”‚
# â”‚ RDS (mydb.xxxx.rds.amazonaws.com:5432)     â”‚
# â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

# âœ… Bastionë³´ë‹¤ ì•ˆì „!
# âœ… SSH í¬íŠ¸ ì•ˆ ì—´ì–´ë„ ë¨
```

### ë°©ë²• 3: RDS Proxy í™œìš© (ì„ íƒì‚¬í•­)

```
RDS Proxy = Lambda, ECS ë“±ì—ì„œ DB ì—°ê²° í’€ ê´€ë¦¬

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Lambda (Private Subnet)                                 â”‚
â”‚   â†“                                                     â”‚
â”‚ RDS Proxy (ì—°ê²° í’€ ê´€ë¦¬)                                â”‚
â”‚   â†“                                                     â”‚
â”‚ RDS (PostgreSQL)                                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ì¥ì :
â€¢ ì—°ê²° ìˆ˜ ì œí•œ ë°©ì§€
â€¢ Failover ì‹œê°„ ë‹¨ì¶• (66% ê°ì†Œ)
â€¢ IAM ì¸ì¦ ê°€ëŠ¥

ë¹„ìš©:
â€¢ $0.015/ì‹œê°„ Ã— vCPU ìˆ˜

ğŸ’¡ Lambda ë§ì´ ì“°ë©´ í•„ìˆ˜, ì•„ë‹ˆë©´ ë¶ˆí•„ìš”
```

---

## ì‹¤ì „ ì‹œë‚˜ë¦¬ì˜¤ì™€ ì„ íƒ ê¸°ì¤€

### ì‹œë‚˜ë¦¬ì˜¤ 1: ìŠ¤íƒ€íŠ¸ì—… (ì†Œê·œëª¨)

```
ìš”êµ¬ì‚¬í•­:
â€¢ íŒ€ 3ëª…
â€¢ ë¹„ìš© ë¯¼ê°
â€¢ ë¹ ë¥¸ êµ¬ì¶•

âœ… ì¶”ì²œ: Bastion Host

êµ¬ì„±:
â€¢ Bastion: t3.micro ($7.5/ì›”)
â€¢ ê´€ë¦¬ì IPë§Œ SSH í—ˆìš©
â€¢ CloudWatch ë¡œê·¸ ì „ì†¡

ì´ìœ :
â€¢ ì„¤ì • ê°„ë‹¨
â€¢ ë¹„ìš© ì €ë ´
â€¢ íŒ€ì´ ì‘ì•„ì„œ SSH í‚¤ ê´€ë¦¬ ë¶€ë‹´ ì ìŒ
```

### ì‹œë‚˜ë¦¬ì˜¤ 2: ì¤‘ê²¬ ê¸°ì—… (ë³´ì•ˆ ì¤‘ì‹œ)

```
ìš”êµ¬ì‚¬í•­:
â€¢ íŒ€ 10~20ëª…
â€¢ ì»´í”Œë¼ì´ì–¸ìŠ¤ (ISO, SOC2)
â€¢ ëª¨ë“  ì ‘ì† ë¡œê·¸ í•„ìˆ˜
â€¢ MFA í•„ìš”

âœ… ì¶”ì²œ: Session Manager

êµ¬ì„±:
â€¢ VPC Endpoint 3ê°œ (SSM ê´€ë ¨)
â€¢ IAM Policyë¡œ ê¶Œí•œ ì„¸ë¶„í™”
â€¢ CloudWatch Logs ìë™ ê¸°ë¡
â€¢ IAM MFA ê°•ì œ

ì´ìœ :
â€¢ ëª¨ë“  ì„¸ì…˜ ìë™ ë¡œê·¸ (ê°ì‚¬ ì¶”ì )
â€¢ IAMìœ¼ë¡œ ì„¸ë°€í•œ ê¶Œí•œ ì œì–´
â€¢ MFA ì—°ë™ ì‰¬ì›€
â€¢ ê´€ë¦¬ ë¶€ë‹´ ì—†ìŒ
```

### ì‹œë‚˜ë¦¬ì˜¤ 3: ëŒ€ê¸°ì—… (ì—”í„°í”„ë¼ì´ì¦ˆ)

```
ìš”êµ¬ì‚¬í•­:
â€¢ ì—¬ëŸ¬ VPC, ì—¬ëŸ¬ ë¦¬ì „
â€¢ ì˜¨í”„ë ˆë¯¸ìŠ¤ ì—°ë™
â€¢ ì¤‘ì•™ ì§‘ì¤‘ì‹ ì ‘ê·¼ ê´€ë¦¬

âœ… ì¶”ì²œ: Session Manager + VPN/Direct Connect

êµ¬ì„±:
â€¢ AWS Transit Gateway (VPC ì—°ê²°)
â€¢ Direct Connect (ì˜¨í”„ë ˆë¯¸ìŠ¤ ì—°ê²°)
â€¢ Session Manager (ëª¨ë“  EC2 ì ‘ì†)
â€¢ CloudWatch + CloudTrail (ì¤‘ì•™ ë¡œê¹…)

ì´ìœ :
â€¢ ëŒ€ê·œëª¨ í™˜ê²½ì—ì„œ Bastion ê´€ë¦¬ ì–´ë ¤ì›€
â€¢ ì˜¨í”„ë ˆë¯¸ìŠ¤ì—ì„œë„ Session Manager ì‚¬ìš© ê°€ëŠ¥
â€¢ ì¤‘ì•™ì—ì„œ ëª¨ë“  ì ‘ì† ëª¨ë‹ˆí„°ë§
```

### ì„ íƒ í”Œë¡œìš°ì°¨íŠ¸

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ë³´ì•ˆ/ì»´í”Œë¼ì´ì–¸ìŠ¤ ìš”êµ¬ì‚¬í•­ ë†’ì€ê°€?  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”
        â”‚ Yes         â”‚ No
        â–¼             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Session       â”‚  â”‚ íŒ€ ê·œëª¨?      â”‚
â”‚ Manager âœ…    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”
                    â”‚ < 5ëª…       â”‚ >= 5ëª…
                    â–¼             â–¼
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚ Bastion    â”‚  â”‚ Session      â”‚
              â”‚ Host       â”‚  â”‚ Manager      â”‚
              â”‚ (ì €ë ´) âœ…  â”‚  â”‚ (ê´€ë¦¬ í¸í•¨) âœ…â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## í•µì‹¬ ì •ë¦¬

### ğŸ¯ 5ê°€ì§€ í•µì‹¬ ì›ì¹™

```
1ï¸âƒ£ Private Subnet ì ‘ì†ì€ 3ê°€ì§€ ë°©ë²•
   â€¢ Bastion Host (ì „í†µì )
   â€¢ Session Manager (ìµœì‹  ê¶Œì¥)
   â€¢ VPN/Direct Connect (ê¸°ì—…ìš©)

2ï¸âƒ£ Bastionì€ ê°„ë‹¨í•˜ì§€ë§Œ ê´€ë¦¬ ë¶€ë‹´
   â€¢ SSH í¬íŠ¸ ë…¸ì¶œ (ë³´ì•ˆ ìœ„í—˜)
   â€¢ ì¸í”„ë¼ ìš´ì˜ í•„ìš” (íŒ¨ì¹˜, ì—…ë°ì´íŠ¸)
   â€¢ ë‹¨ì¼ ì¥ì• ì 

3ï¸âƒ£ Session ManagerëŠ” Serverless
   â€¢ ì¸í”„ë¼ ê´€ë¦¬ ë¶ˆí•„ìš”
   â€¢ ìë™ ë¡œê·¸ ê¸°ë¡
   â€¢ IAM ê¶Œí•œ ì œì–´
   â€¢ MFA ì—°ë™

4ï¸âƒ£ RDS ì ‘ì†ì€ í„°ë„ ë˜ëŠ” í¬íŠ¸ í¬ì›Œë”©
   â€¢ Bastion SSH í„°ë„
   â€¢ Session Manager í¬íŠ¸ í¬ì›Œë”©
   â€¢ ë‘˜ ë‹¤ ë¡œì»¬ GUI ë„êµ¬ ì‚¬ìš© ê°€ëŠ¥

5ï¸âƒ£ ì„ íƒ ê¸°ì¤€ì€ ê·œëª¨ì™€ ë³´ì•ˆ ìš”êµ¬ì‚¬í•­
   â€¢ ì†Œê·œëª¨ + ë¹„ìš© ë¯¼ê° â†’ Bastion
   â€¢ ì¤‘ëŒ€ê·œëª¨ + ë³´ì•ˆ ì¤‘ìš” â†’ Session Manager
   â€¢ ì—”í„°í”„ë¼ì´ì¦ˆ â†’ Session Manager + VPN
```

### ğŸ§  ì´í•´ë„ ìê°€ í…ŒìŠ¤íŠ¸

```
Q1: Private Subnet EC2ì— SSH ì ‘ì†í•˜ë ¤ë©´?
A1: Bastion Host ê±°ì³ì„œ ë˜ëŠ” Session Manager ì‚¬ìš©.

Q2: Session ManagerëŠ” ì™œ SSH í¬íŠ¸ê°€ í•„ìš” ì—†ë‚˜?
A2: HTTPS(443)ë¡œ SSM Serviceì™€ í†µì‹ í•˜ë¯€ë¡œ. SSHëŠ” ì‚¬ìš© ì•ˆ í•¨.

Q3: RDSì— ì§ì ‘ SSH ì ‘ì†í•  ìˆ˜ ìˆë‚˜?
A3: âŒ ë¶ˆê°€ëŠ¥. RDSëŠ” Managed Service. í¬íŠ¸ í¬ì›Œë”©ìœ¼ë¡œ DB í´ë¼ì´ì–¸íŠ¸ ì ‘ì†ë§Œ ê°€ëŠ¥.

Q4: Session Managerì˜ ê°€ì¥ í° ì¥ì ì€?
A4: ëª¨ë“  ì„¸ì…˜ ìë™ ë¡œê·¸ ê¸°ë¡ (ê°ì‚¬ ì¶”ì ), IAM ê¶Œí•œ ì œì–´, ê´€ë¦¬ ë¶ˆí•„ìš”.

Q5: Bastion Hostì˜ ë³´ì•ˆê·¸ë£¹ Inbound SourceëŠ”?
A5: ê´€ë¦¬ì IPë§Œ í—ˆìš© (0.0.0.0/0ì€ ì ˆëŒ€ ê¸ˆì§€!).
```

---

## ë‹¤ìŒ ë‹¨ê³„

ì´ì œ Private ì„œë¸Œë„· ì ‘ê·¼ì„ ì™„ë²½íˆ ì´í•´í–ˆìœ¼ë‹ˆ:

1. **VPC Peering / Transit Gateway**: ì—¬ëŸ¬ VPC ì—°ê²°
2. **CloudWatch + VPC Flow Logs**: ë„¤íŠ¸ì›Œí¬ ëª¨ë‹ˆí„°ë§
3. **AWS Direct Connect**: ì˜¨í”„ë ˆë¯¸ìŠ¤ ì—°ê²°

---

*ë§ˆì§€ë§‰ ì—…ë°ì´íŠ¸: 2026-01-13*
